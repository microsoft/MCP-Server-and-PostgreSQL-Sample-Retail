<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4a903b684f72790625340375b1a033c6",
  "translation_date": "2025-09-29T18:25:46+00:00",
  "source_file": "walkthrough/00-Introduction/README.md",
  "language_code": "fa"
}
-->
# معرفی یکپارچه‌سازی پایگاه داده MCP

## 🎯 این ماژول چه چیزی را پوشش می‌دهد؟

این ماژول مقدماتی یک مرور جامع از ساخت سرورهای پروتکل زمینه مدل (MCP) با یکپارچه‌سازی پایگاه داده ارائه می‌دهد. شما از طریق مطالعه موردی تحلیل‌های خرده‌فروشی Zava، با موارد تجاری، معماری فنی و کاربردهای واقعی آشنا خواهید شد.

## مرور کلی

**پروتکل زمینه مدل (MCP)** به دستیاران هوش مصنوعی امکان می‌دهد تا به صورت امن به منابع داده خارجی دسترسی پیدا کرده و با آن‌ها در زمان واقعی تعامل کنند. هنگامی که MCP با یکپارچه‌سازی پایگاه داده ترکیب می‌شود، قابلیت‌های قدرتمندی برای برنامه‌های هوش مصنوعی مبتنی بر داده فراهم می‌کند.

این مسیر یادگیری به شما آموزش می‌دهد که چگونه سرورهای MCP آماده تولید بسازید که دستیاران هوش مصنوعی را به داده‌های فروش خرده‌فروشی از طریق PostgreSQL متصل کند و الگوهای سازمانی مانند امنیت سطح ردیف، جستجوی معنایی و دسترسی چند مستاجری به داده‌ها را پیاده‌سازی کند.

## اهداف یادگیری

در پایان این ماژول، شما قادر خواهید بود:

- **تعریف کنید** پروتکل زمینه مدل و مزایای اصلی آن برای یکپارچه‌سازی پایگاه داده
- **شناسایی کنید** اجزای کلیدی معماری سرور MCP با پایگاه داده‌ها
- **درک کنید** مطالعه موردی Zava Retail و نیازهای تجاری آن
- **تشخیص دهید** الگوهای سازمانی برای دسترسی امن و مقیاس‌پذیر به پایگاه داده
- **فهرست کنید** ابزارها و فناوری‌های استفاده شده در این مسیر یادگیری

## 🧭 چالش: هوش مصنوعی و داده‌های دنیای واقعی

### محدودیت‌های سنتی هوش مصنوعی

دستیاران هوش مصنوعی مدرن بسیار قدرتمند هستند اما هنگام کار با داده‌های تجاری واقعی با محدودیت‌های قابل توجهی مواجه می‌شوند:

| **چالش** | **توضیحات** | **تأثیر تجاری** |
|----------|-------------|------------------|
| **دانش ثابت** | مدل‌های هوش مصنوعی که بر اساس مجموعه داده‌های ثابت آموزش دیده‌اند نمی‌توانند به داده‌های جاری تجاری دسترسی پیدا کنند | بینش‌های قدیمی، فرصت‌های از دست رفته |
| **سیلوهای داده** | اطلاعات در پایگاه داده‌ها، API‌ها و سیستم‌هایی قفل شده‌اند که هوش مصنوعی نمی‌تواند به آن‌ها دسترسی پیدا کند | تحلیل ناقص، جریان‌های کاری پراکنده |
| **محدودیت‌های امنیتی** | دسترسی مستقیم به پایگاه داده‌ها نگرانی‌های امنیتی و انطباقی ایجاد می‌کند | استقرار محدود، آماده‌سازی دستی داده‌ها |
| **پرسش‌های پیچیده** | کاربران تجاری نیاز به دانش فنی برای استخراج بینش‌های داده دارند | کاهش پذیرش، فرآیندهای ناکارآمد |

### راه‌حل MCP

پروتکل زمینه مدل این چالش‌ها را با ارائه موارد زیر حل می‌کند:

- **دسترسی به داده‌های زمان واقعی**: دستیاران هوش مصنوعی پایگاه داده‌ها و API‌های زنده را پرس‌وجو می‌کنند
- **یکپارچه‌سازی امن**: دسترسی کنترل‌شده با احراز هویت و مجوزها
- **رابط زبان طبیعی**: کاربران تجاری سوالات خود را به زبان ساده مطرح می‌کنند
- **پروتکل استاندارد**: سازگار با پلتفرم‌ها و ابزارهای مختلف هوش مصنوعی

## 🏪 آشنایی با Zava Retail: مطالعه موردی آموزشی ما

در طول این مسیر یادگیری، ما یک سرور MCP برای **Zava Retail**، یک زنجیره خرده‌فروشی DIY خیالی با چندین مکان فروشگاه، خواهیم ساخت. این سناریوی واقعی پیاده‌سازی MCP در سطح سازمانی را نشان می‌دهد.

### زمینه تجاری

**Zava Retail** فعالیت می‌کند:
- **8 فروشگاه فیزیکی** در ایالت واشنگتن (سیاتل، بلویو، تاکوما، اسپوکین، اورت، ردموند، کرکلند)
- **1 فروشگاه آنلاین** برای فروش‌های تجارت الکترونیک
- **کاتالوگ محصولات متنوع** شامل ابزارها، سخت‌افزار، لوازم باغبانی و مصالح ساختمانی
- **مدیریت چند سطحی** با مدیران فروشگاه، مدیران منطقه‌ای و مدیران اجرایی

### نیازهای تجاری

مدیران فروشگاه و مدیران اجرایی به تحلیل‌های هوش مصنوعی نیاز دارند تا:

1. **عملکرد فروش** را در فروشگاه‌ها و دوره‌های زمانی مختلف تحلیل کنند
2. **سطوح موجودی** را پیگیری کرده و نیازهای بازپروری را شناسایی کنند
3. **رفتار مشتری** و الگوهای خرید را درک کنند
4. **بینش‌های محصول** را از طریق جستجوی معنایی کشف کنند
5. **گزارش‌ها** را با پرسش‌های زبان طبیعی تولید کنند
6. **امنیت داده‌ها** را با کنترل دسترسی مبتنی بر نقش حفظ کنند

### نیازهای فنی

سرور MCP باید ارائه دهد:

- **دسترسی چند مستاجری به داده‌ها** که مدیران فروشگاه فقط داده‌های فروشگاه خود را ببینند
- **پرس‌وجوی انعطاف‌پذیر** که از عملیات پیچیده SQL پشتیبانی کند
- **جستجوی معنایی** برای کشف محصولات و توصیه‌ها
- **داده‌های زمان واقعی** که وضعیت جاری تجاری را منعکس کند
- **احراز هویت امن** با امنیت سطح ردیف
- **معماری مقیاس‌پذیر** که از کاربران همزمان متعدد پشتیبانی کند

## 🏗️ مرور معماری سرور MCP

سرور MCP ما معماری لایه‌ای را پیاده‌سازی می‌کند که برای یکپارچه‌سازی پایگاه داده بهینه شده است:

```
┌─────────────────────────────────────────────────────────────┐
│                    VS Code AI Client                       │
│                  (Natural Language Queries)                │
└─────────────────────┬───────────────────────────────────────┘
                      │ HTTP/SSE
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                     MCP Server                             │
│  ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐ │
│  │   Tool Layer    │ │  Security Layer │ │  Config Layer │ │
│  │                 │ │                 │ │               │ │
│  │ • Query Tools   │ │ • RLS Context   │ │ • Environment │ │
│  │ • Schema Tools  │ │ • User Identity │ │ • Connections │ │
│  │ • Search Tools  │ │ • Access Control│ │ • Validation  │ │
│  └─────────────────┘ └─────────────────┘ └───────────────┘ │
└─────────────────────┬───────────────────────────────────────┘
                      │ asyncpg
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                PostgreSQL Database                         │
│  ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐ │
│  │  Retail Schema  │ │   RLS Policies  │ │   pgvector    │ │
│  │                 │ │                 │ │               │ │
│  │ • Stores        │ │ • Store-based   │ │ • Embeddings  │ │
│  │ • Customers     │ │   Isolation     │ │ • Similarity  │ │
│  │ • Products      │ │ • Role Control  │ │   Search      │ │
│  │ • Orders        │ │ • Audit Logs    │ │               │ │
│  └─────────────────┘ └─────────────────┘ └───────────────┘ │
└─────────────────────┬───────────────────────────────────────┘
                      │ REST API
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                  Azure OpenAI                              │
│               (Text Embeddings)                            │
└─────────────────────────────────────────────────────────────┘
```

### اجزای کلیدی

#### **1. لایه سرور MCP**
- **FastMCP Framework**: پیاده‌سازی مدرن سرور MCP با پایتون
- **ثبت ابزار**: تعریف ابزارهای اعلامی با ایمنی نوع
- **زمینه درخواست**: مدیریت هویت کاربر و جلسه
- **مدیریت خطا**: مدیریت خطا و ثبت گزارش قوی

#### **2. لایه یکپارچه‌سازی پایگاه داده**
- **مدیریت اتصال**: مدیریت اتصال asyncpg کارآمد
- **ارائه‌دهنده طرح‌واره**: کشف پویا طرح‌واره جدول
- **اجرای پرس‌وجو**: اجرای امن SQL با زمینه RLS
- **مدیریت تراکنش**: انطباق ACID و مدیریت بازگشت

#### **3. لایه امنیت**
- **امنیت سطح ردیف**: RLS PostgreSQL برای جداسازی داده‌های چند مستاجری
- **هویت کاربر**: احراز هویت و مجوز مدیر فروشگاه
- **کنترل دسترسی**: مجوزهای دقیق و ردگیری حسابرسی
- **اعتبارسنجی ورودی**: جلوگیری از تزریق SQL و اعتبارسنجی پرس‌وجو

#### **4. لایه تقویت هوش مصنوعی**
- **جستجوی معنایی**: جاسازی برداری برای کشف محصولات
- **یکپارچه‌سازی Azure OpenAI**: تولید جاسازی متن
- **الگوریتم‌های شباهت**: جستجوی شباهت کسینوسی pgvector
- **بهینه‌سازی جستجو**: ایندکس‌گذاری و تنظیم عملکرد

## 🔧 فناوری‌های مورد استفاده

### فناوری‌های اصلی

| **جزء** | **فناوری** | **هدف** |
|---------|------------|---------|
| **چارچوب MCP** | FastMCP (پایتون) | پیاده‌سازی مدرن سرور MCP |
| **پایگاه داده** | PostgreSQL 17 + pgvector | داده‌های رابطه‌ای با جستجوی برداری |
| **خدمات هوش مصنوعی** | Azure OpenAI | جاسازی متن و مدل‌های زبانی |
| **کانتینرسازی** | Docker + Docker Compose | محیط توسعه |
| **پلتفرم ابری** | Microsoft Azure | استقرار تولید |
| **یکپارچه‌سازی IDE** | VS Code | چت هوش مصنوعی و جریان کاری توسعه |

### ابزارهای توسعه

| **ابزار** | **هدف** |
|-----------|---------|
| **asyncpg** | درایور PostgreSQL با عملکرد بالا |
| **Pydantic** | اعتبارسنجی داده و سریال‌سازی |
| **Azure SDK** | یکپارچه‌سازی خدمات ابری |
| **pytest** | چارچوب تست |
| **Docker** | کانتینرسازی و استقرار |

### پشته تولید

| **خدمت** | **منبع Azure** | **هدف** |
|----------|----------------|---------|
| **پایگاه داده** | Azure Database for PostgreSQL | خدمت پایگاه داده مدیریت‌شده |
| **کانتینر** | Azure Container Apps | میزبانی کانتینر بدون سرور |
| **خدمات هوش مصنوعی** | Azure AI Foundry | مدل‌ها و نقاط پایانی OpenAI |
| **نظارت** | Application Insights | مشاهده‌پذیری و تشخیص |
| **امنیت** | Azure Key Vault | مدیریت اسرار و پیکربندی |

## 🎬 سناریوهای استفاده واقعی

بیایید بررسی کنیم که چگونه کاربران مختلف با سرور MCP ما تعامل دارند:

### سناریو 1: بررسی عملکرد مدیر فروشگاه

**کاربر**: سارا، مدیر فروشگاه سیاتل  
**هدف**: تحلیل عملکرد فروش سه‌ماهه گذشته

**پرسش زبان طبیعی**:
> "10 محصول برتر بر اساس درآمد برای فروشگاه من در سه‌ماهه چهارم 2024 را نشان بده"

**چه اتفاقی می‌افتد**:
1. چت هوش مصنوعی VS Code پرسش را به سرور MCP ارسال می‌کند
2. سرور MCP زمینه فروشگاه سارا (سیاتل) را شناسایی می‌کند
3. سیاست‌های RLS داده‌ها را فقط به فروشگاه سیاتل فیلتر می‌کند
4. پرس‌وجوی SQL تولید و اجرا می‌شود
5. نتایج قالب‌بندی شده و به چت هوش مصنوعی بازگردانده می‌شود
6. هوش مصنوعی تحلیل و بینش‌ها را ارائه می‌دهد

### سناریو 2: کشف محصول با جستجوی معنایی

**کاربر**: مایک، مدیر موجودی  
**هدف**: یافتن محصولات مشابه درخواست مشتری

**پرسش زبان طبیعی**:
> "چه محصولاتی می‌فروشیم که مشابه 'اتصالات الکتریکی ضدآب برای استفاده در فضای باز' باشند؟"

**چه اتفاقی می‌افتد**:
1. پرسش توسط ابزار جستجوی معنایی پردازش می‌شود
2. Azure OpenAI بردار جاسازی تولید می‌کند
3. pgvector جستجوی شباهت را انجام می‌دهد
4. محصولات مرتبط بر اساس ارتباط رتبه‌بندی می‌شوند
5. نتایج شامل جزئیات محصول و موجودی است
6. هوش مصنوعی جایگزین‌ها و فرصت‌های بسته‌بندی را پیشنهاد می‌دهد

### سناریو 3: تحلیل‌های بین فروشگاهی

**کاربر**: جنیفر، مدیر منطقه‌ای  
**هدف**: مقایسه عملکرد در تمام فروشگاه‌ها

**پرسش زبان طبیعی**:
> "فروش بر اساس دسته‌بندی را برای تمام فروشگاه‌ها در 6 ماه گذشته مقایسه کن"

**چه اتفاقی می‌افتد**:
1. زمینه RLS برای دسترسی مدیر منطقه‌ای تنظیم می‌شود
2. پرس‌وجوی پیچیده چند فروشگاهی تولید می‌شود
3. داده‌ها در مکان‌های فروشگاه جمع‌آوری می‌شوند
4. نتایج شامل روندها و مقایسه‌ها است
5. هوش مصنوعی بینش‌ها و توصیه‌ها را شناسایی می‌کند

## 🔒 بررسی عمیق امنیت و چند مستاجری

پیاده‌سازی ما امنیت در سطح سازمانی را در اولویت قرار می‌دهد:

### امنیت سطح ردیف (RLS)

RLS PostgreSQL جداسازی داده‌ها را تضمین می‌کند:

```sql
-- Store managers see only their store's data
CREATE POLICY store_manager_policy ON retail.orders
  FOR ALL TO store_managers
  USING (store_id = get_current_user_store());

-- Regional managers see multiple stores
CREATE POLICY regional_manager_policy ON retail.orders
  FOR ALL TO regional_managers
  USING (store_id = ANY(get_user_store_list()));
```

### مدیریت هویت کاربر

هر اتصال MCP شامل موارد زیر است:
- **شناسه مدیر فروشگاه**: شناسه منحصر به فرد برای زمینه RLS
- **اختصاص نقش**: مجوزها و سطوح دسترسی
- **مدیریت جلسه**: توکن‌های احراز هویت امن
- **ثبت حسابرسی**: تاریخچه کامل دسترسی

### حفاظت از داده‌ها

چندین لایه امنیتی:
- **رمزگذاری اتصال**: TLS برای تمام اتصالات پایگاه داده
- **جلوگیری از تزریق SQL**: فقط پرس‌وجوهای پارامتری
- **اعتبارسنجی ورودی**: اعتبارسنجی جامع درخواست‌ها
- **مدیریت خطا**: عدم نمایش داده حساس در پیام‌های خطا

## 🎯 نکات کلیدی

پس از تکمیل این مقدمه، شما باید درک کنید:

✅ **ارزش MCP**: چگونه MCP دستیاران هوش مصنوعی و داده‌های واقعی را به هم متصل می‌کند  
✅ **زمینه تجاری**: نیازها و چالش‌های Zava Retail  
✅ **مرور معماری**: اجزای کلیدی و تعاملات آن‌ها  
✅ **فناوری‌های مورد استفاده**: ابزارها و چارچوب‌های استفاده شده  
✅ **مدل امنیتی**: دسترسی چند مستاجری به داده‌ها و حفاظت  
✅ **الگوهای استفاده**: سناریوهای پرس‌وجوی واقعی و جریان‌های کاری  

## 🚀 مرحله بعدی

آماده برای عمیق‌تر شدن؟ ادامه دهید با:

**[ماژول 01: مفاهیم اصلی معماری](../01-Architecture/README.md)**

درباره الگوهای معماری سرور MCP، اصول طراحی پایگاه داده و پیاده‌سازی فنی دقیق که راه‌حل تحلیل‌های خرده‌فروشی ما را قدرت می‌بخشد، یاد بگیرید.

## 📚 منابع اضافی

### مستندات MCP
- [مشخصات MCP](https://modelcontextprotocol.io/docs/) - مستندات رسمی پروتکل
- [MCP برای مبتدیان](https://aka.ms/mcp-for-beginners) - راهنمای جامع یادگیری MCP
- [مستندات FastMCP](https://github.com/modelcontextprotocol/python-sdk) - مستندات SDK پایتون

### یکپارچه‌سازی پایگاه داده
- [مستندات PostgreSQL](https://www.postgresql.org/docs/) - مرجع کامل PostgreSQL
- [راهنمای pgvector](https://github.com/pgvector/pgvector) - مستندات افزونه برداری
- [امنیت سطح ردیف](https://www.postgresql.org/docs/current/ddl-rowsecurity.html) - راهنمای RLS PostgreSQL

### خدمات Azure
- [مستندات Azure OpenAI](https://docs.microsoft.com/azure/cognitive-services/openai/) - یکپارچه‌سازی خدمات هوش مصنوعی
- [Azure Database for PostgreSQL](https://docs.microsoft.com/azure/postgresql/) - خدمت پایگاه داده مدیریت‌شده
- [Azure Container Apps](https://docs.microsoft.com/azure/container-apps/) - کانتینرهای بدون سرور

---

**توجه**: این یک تمرین آموزشی با داده‌های خرده‌فروشی خیالی است. همیشه هنگام پیاده‌سازی راه‌حل‌های مشابه در محیط‌های تولید، از سیاست‌های حاکمیت داده و امنیت سازمان خود پیروی کنید.

---

**سلب مسئولیت**:  
این سند با استفاده از سرویس ترجمه هوش مصنوعی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما تلاش می‌کنیم دقت را حفظ کنیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است شامل خطاها یا نادرستی‌ها باشند. سند اصلی به زبان اصلی آن باید به عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حساس، ترجمه حرفه‌ای انسانی توصیه می‌شود. ما مسئولیتی در قبال سوء تفاهم‌ها یا تفسیرهای نادرست ناشی از استفاده از این ترجمه نداریم.