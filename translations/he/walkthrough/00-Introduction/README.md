<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "4a903b684f72790625340375b1a033c6",
  "translation_date": "2025-09-29T22:29:04+00:00",
  "source_file": "walkthrough/00-Introduction/README.md",
  "language_code": "he"
}
-->
# מבוא לשילוב מסדי נתונים עם MCP

## 🎯 מה מכסה המודול הזה

מודול המבוא הזה מספק סקירה מקיפה על בניית שרתי Model Context Protocol (MCP) עם שילוב מסדי נתונים. תלמדו על המקרה העסקי, הארכיטקטורה הטכנית ויישומים בעולם האמיתי דרך מקרה הבוחן של ניתוחי Zava Retail.

## סקירה כללית

**Model Context Protocol (MCP)** מאפשר לעוזרים מבוססי AI לגשת בצורה מאובטחת ולהתנהל עם מקורות נתונים חיצוניים בזמן אמת. בשילוב עם מסדי נתונים, MCP פותח יכולות עוצמתיות ליישומי AI מבוססי נתונים.

מסלול הלמידה הזה מלמד כיצד לבנות שרתי MCP מוכנים לייצור שמחברים עוזרי AI לנתוני מכירות קמעונאיים דרך PostgreSQL, תוך יישום דפוסים ארגוניים כמו אבטחת רמות שורה, חיפוש סמנטי וגישה לנתונים מרובי דיירים.

## מטרות למידה

בסיום המודול הזה, תוכלו:

- **להגדיר** את Model Context Protocol ואת היתרונות המרכזיים שלו לשילוב מסדי נתונים  
- **לזהות** רכיבים מרכזיים בארכיטקטורת שרת MCP עם מסדי נתונים  
- **להבין** את מקרה הבוחן של Zava Retail ואת הדרישות העסקיות שלו  
- **להכיר** דפוסים ארגוניים לגישה מאובטחת ומדרגית לנתונים  
- **לפרט** את הכלים והטכנולוגיות המשמשים לאורך מסלול הלמידה הזה  

## 🧭 האתגר: AI פוגש נתונים מהעולם האמיתי

### מגבלות AI מסורתיות

עוזרי AI מודרניים הם חזקים מאוד אך מתמודדים עם מגבלות משמעותיות בעבודה עם נתונים עסקיים מהעולם האמיתי:

| **אתגר** | **תיאור** | **השפעה עסקית** |
|----------|-----------|------------------|
| **ידע סטטי** | מודלי AI מאומנים על מערכי נתונים קבועים לא יכולים לגשת לנתונים עסקיים עדכניים | תובנות מיושנות, הזדמנויות מפוספסות |
| **סילוים של נתונים** | מידע נעול במסדי נתונים, APIs ומערכות שה-AI לא יכול להגיע אליהם | ניתוח לא שלם, זרימות עבודה מקוטעות |
| **מגבלות אבטחה** | גישה ישירה למסדי נתונים מעלה חששות אבטחה וציות | פריסה מוגבלת, הכנת נתונים ידנית |
| **שאילתות מורכבות** | משתמשים עסקיים זקוקים לידע טכני כדי להפיק תובנות מנתונים | אימוץ מופחת, תהליכים לא יעילים |

### הפתרון של MCP

Model Context Protocol מתמודד עם האתגרים הללו על ידי מתן:

- **גישה לנתונים בזמן אמת**: עוזרי AI מבצעים שאילתות למסדי נתונים ו-APIs חיים  
- **שילוב מאובטח**: גישה מבוקרת עם אימות והרשאות  
- **ממשק בשפה טבעית**: משתמשים עסקיים שואלים שאלות באנגלית פשוטה  
- **פרוטוקול סטנדרטי**: עובד עם פלטפורמות וכלי AI שונים  

## 🏪 הכירו את Zava Retail: מקרה הבוחן שלנו

לאורך מסלול הלמידה הזה, נבנה שרת MCP עבור **Zava Retail**, רשת קמעונאית בדיונית של עשה זאת בעצמך עם מספר סניפים. תרחיש מציאותי זה מדגים יישום MCP ברמה ארגונית.

### הקשר עסקי

**Zava Retail** מפעילה:
- **8 חנויות פיזיות** ברחבי מדינת וושינגטון (סיאטל, בלוויו, טאקומה, ספוקיין, אברט, רדמונד, קירקלנד)  
- **חנות מקוונת אחת** למכירות באינטרנט  
- **קטלוג מוצרים מגוון** הכולל כלים, חומרי בניין, ציוד גינה וחומרי בנייה  
- **ניהול רב-שכבתי** עם מנהלי חנויות, מנהלים אזוריים ומנהלים בכירים  

### דרישות עסקיות

מנהלי חנויות ומנהלים בכירים זקוקים לניתוחי AI כדי:

1. **לנתח ביצועי מכירות** בין חנויות ותקופות זמן  
2. **לעקוב אחר רמות מלאי** ולזהות צרכים למילוי מחדש  
3. **להבין התנהגות לקוחות** ודפוסי רכישה  
4. **לגלות תובנות על מוצרים** דרך חיפוש סמנטי  
5. **ליצור דוחות** עם שאילתות בשפה טבעית  
6. **לשמור על אבטחת נתונים** עם בקרת גישה מבוססת תפקידים  

### דרישות טכניות

שרת MCP חייב לספק:

- **גישה לנתונים מרובי דיירים** שבה מנהלי חנויות רואים רק את נתוני החנות שלהם  
- **שאילתות גמישות** התומכות בפעולות SQL מורכבות  
- **חיפוש סמנטי** לגילוי מוצרים והמלצות  
- **נתונים בזמן אמת** המשקפים את מצב העסק הנוכחי  
- **אימות מאובטח** עם אבטחת רמות שורה  
- **ארכיטקטורה מדרגית** התומכת במספר משתמשים בו-זמנית  

## 🏗️ סקירה כללית של ארכיטקטורת שרת MCP

שרת MCP שלנו מיישם ארכיטקטורה שכבתית המותאמת לשילוב מסדי נתונים:

```
┌─────────────────────────────────────────────────────────────┐
│                    VS Code AI Client                       │
│                  (Natural Language Queries)                │
└─────────────────────┬───────────────────────────────────────┘
                      │ HTTP/SSE
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                     MCP Server                             │
│  ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐ │
│  │   Tool Layer    │ │  Security Layer │ │  Config Layer │ │
│  │                 │ │                 │ │               │ │
│  │ • Query Tools   │ │ • RLS Context   │ │ • Environment │ │
│  │ • Schema Tools  │ │ • User Identity │ │ • Connections │ │
│  │ • Search Tools  │ │ • Access Control│ │ • Validation  │ │
│  └─────────────────┘ └─────────────────┘ └───────────────┘ │
└─────────────────────┬───────────────────────────────────────┘
                      │ asyncpg
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                PostgreSQL Database                         │
│  ┌─────────────────┐ ┌─────────────────┐ ┌───────────────┐ │
│  │  Retail Schema  │ │   RLS Policies  │ │   pgvector    │ │
│  │                 │ │                 │ │               │ │
│  │ • Stores        │ │ • Store-based   │ │ • Embeddings  │ │
│  │ • Customers     │ │   Isolation     │ │ • Similarity  │ │
│  │ • Products      │ │ • Role Control  │ │   Search      │ │
│  │ • Orders        │ │ • Audit Logs    │ │               │ │
│  └─────────────────┘ └─────────────────┘ └───────────────┘ │
└─────────────────────┬───────────────────────────────────────┘
                      │ REST API
                      ▼
┌─────────────────────────────────────────────────────────────┐
│                  Azure OpenAI                              │
│               (Text Embeddings)                            │
└─────────────────────────────────────────────────────────────┘
```

### רכיבים מרכזיים

#### **1. שכבת שרת MCP**
- **FastMCP Framework**: יישום שרת MCP מודרני ב-Python  
- **Tool Registration**: הגדרות כלים דקלרטיביות עם בטיחות סוגים  
- **Request Context**: ניהול זהות משתמש ומושב  
- **Error Handling**: ניהול שגיאות ורישום חזק  

#### **2. שכבת שילוב מסדי נתונים**
- **Connection Pooling**: ניהול חיבורי asyncpg יעיל  
- **Schema Provider**: גילוי דינמי של סכמות טבלאות  
- **Query Executor**: ביצוע SQL מאובטח עם הקשר RLS  
- **Transaction Management**: תאימות ACID וטיפול בביטולים  

#### **3. שכבת אבטחה**
- **Row Level Security**: RLS של PostgreSQL לבידוד נתונים מרובי דיירים  
- **User Identity**: אימות והרשאה של מנהלי חנויות  
- **Access Control**: הרשאות מדויקות ונתיבי ביקורת  
- **Input Validation**: מניעת הזרקת SQL ואימות שאילתות  

#### **4. שכבת שיפור AI**
- **Semantic Search**: הטמעות וקטוריות לגילוי מוצרים  
- **Azure OpenAI Integration**: יצירת הטמעות טקסט  
- **Similarity Algorithms**: חיפוש דמיון pgvector  
- **Search Optimization**: אינדוקס וכיוונון ביצועים  

## 🔧 מערך טכנולוגי

### טכנולוגיות ליבה

| **רכיב** | **טכנולוגיה** | **מטרה** |
|----------|---------------|----------|
| **MCP Framework** | FastMCP (Python) | יישום שרת MCP מודרני |
| **מסד נתונים** | PostgreSQL 17 + pgvector | נתונים יחסיים עם חיפוש וקטורי |
| **שירותי AI** | Azure OpenAI | הטמעות טקסט ומודלים שפתיים |
| **קונטיינריזציה** | Docker + Docker Compose | סביבת פיתוח |
| **פלטפורמת ענן** | Microsoft Azure | פריסה בייצור |
| **אינטגרציה עם IDE** | VS Code | צ'אט AI וזרימת עבודה לפיתוח |

### כלי פיתוח

| **כלי** | **מטרה** |
|---------|----------|
| **asyncpg** | דרייבר PostgreSQL בעל ביצועים גבוהים |
| **Pydantic** | אימות נתונים וסריאליזציה |
| **Azure SDK** | אינטגרציה עם שירותי ענן |
| **pytest** | מסגרת בדיקות |
| **Docker** | קונטיינריזציה ופריסה |

### מערך ייצור

| **שירות** | **משאב Azure** | **מטרה** |
|-----------|----------------|----------|
| **מסד נתונים** | Azure Database for PostgreSQL | שירות מסד נתונים מנוהל |
| **קונטיינר** | Azure Container Apps | אירוח קונטיינרים ללא שרת |
| **שירותי AI** | Azure AI Foundry | מודלים ונקודות קצה של OpenAI |
| **מעקב** | Application Insights | תצפית ואבחון |
| **אבטחה** | Azure Key Vault | ניהול סודות וקונפיגורציה |

## 🎬 תרחישי שימוש בעולם האמיתי

בואו נחקור כיצד משתמשים שונים מתקשרים עם שרת MCP שלנו:

### תרחיש 1: סקירת ביצועי מנהל חנות

**משתמש**: שרה, מנהלת חנות סיאטל  
**מטרה**: לנתח ביצועי מכירות ברבעון האחרון

**שאילתה בשפה טבעית**:  
> "הצג לי את 10 המוצרים המובילים לפי הכנסות עבור החנות שלי ברבעון הרביעי של 2024"

**מה קורה**:
1. צ'אט AI ב-VS Code שולח את השאילתה לשרת MCP  
2. שרת MCP מזהה את הקשר החנות של שרה (סיאטל)  
3. מדיניות RLS מסננת נתונים רק לחנות סיאטל  
4. שאילתת SQL נוצרת ומבוצעת  
5. התוצאות מעוצבות ומוחזרות לצ'אט AI  
6. ה-AI מספק ניתוח ותובנות  

### תרחיש 2: גילוי מוצרים עם חיפוש סמנטי

**משתמש**: מייק, מנהל מלאי  
**מטרה**: למצוא מוצרים דומים לבקשת לקוח

**שאילתה בשפה טבעית**:  
> "אילו מוצרים אנחנו מוכרים שדומים ל'מחברים חשמליים עמידים למים לשימוש חיצוני'?"

**מה קורה**:
1. השאילתה מעובדת על ידי כלי החיפוש הסמנטי  
2. Azure OpenAI מייצר וקטור הטמעה  
3. pgvector מבצע חיפוש דמיון  
4. מוצרים קשורים מדורגים לפי רלוונטיות  
5. התוצאות כוללות פרטי מוצר וזמינות  
6. ה-AI מציע חלופות והזדמנויות לצירוף מוצרים  

### תרחיש 3: ניתוח בין חנויות

**משתמש**: ג'ניפר, מנהלת אזורית  
**מטרה**: להשוות ביצועים בין כל החנויות

**שאילתה בשפה טבעית**:  
> "השווה מכירות לפי קטגוריה עבור כל החנויות ב-6 החודשים האחרונים"

**מה קורה**:
1. הקשר RLS מוגדר לגישה של מנהלת אזורית  
2. שאילתה מורכבת בין חנויות נוצרת  
3. נתונים מצטברים בין מיקומי החנויות  
4. התוצאות כוללות מגמות והשוואות  
5. ה-AI מזהה תובנות והמלצות  

## 🔒 סקירה מעמיקה של אבטחה ורב-דיירות

היישום שלנו נותן עדיפות לאבטחה ברמה ארגונית:

### אבטחת רמות שורה (RLS)

PostgreSQL RLS מבטיח בידוד נתונים:

```sql
-- Store managers see only their store's data
CREATE POLICY store_manager_policy ON retail.orders
  FOR ALL TO store_managers
  USING (store_id = get_current_user_store());

-- Regional managers see multiple stores
CREATE POLICY regional_manager_policy ON retail.orders
  FOR ALL TO regional_managers
  USING (store_id = ANY(get_user_store_list()));
```

### ניהול זהות משתמש

כל חיבור MCP כולל:
- **מזהה מנהל חנות**: מזהה ייחודי להקשר RLS  
- **הקצאת תפקידים**: הרשאות ורמות גישה  
- **ניהול מושבים**: אסימוני אימות מאובטחים  
- **רישום ביקורת**: היסטוריית גישה מלאה  

### הגנת נתונים

שכבות אבטחה מרובות:
- **הצפנת חיבורים**: TLS לכל חיבורי מסד הנתונים  
- **מניעת הזרקת SQL**: שאילתות פרמטריות בלבד  
- **אימות קלט**: אימות בקשות מקיף  
- **טיפול בשגיאות**: ללא נתונים רגישים בהודעות שגיאה  

## 🎯 נקודות מפתח

לאחר השלמת המבוא הזה, תבינו:

✅ **הצעת הערך של MCP**: כיצד MCP מחבר עוזרי AI לנתונים מהעולם האמיתי  
✅ **הקשר עסקי**: דרישות ואתגרים של Zava Retail  
✅ **סקירת ארכיטקטורה**: רכיבים מרכזיים ואינטראקציות ביניהם  
✅ **מערך טכנולוגי**: כלים ומסגרות המשמשים לאורך הדרך  
✅ **מודל אבטחה**: גישה לנתונים מרובי דיירים והגנה  
✅ **דפוסי שימוש**: תרחישי שאילתות וזרימות עבודה בעולם האמיתי  

## 🚀 מה הלאה

מוכנים לצלול עמוק יותר? המשיכו עם:

**[מודול 01: מושגי ארכיטקטורה מרכזיים](../01-Architecture/README.md)**

למדו על דפוסי ארכיטקטורת שרת MCP, עקרונות עיצוב מסדי נתונים והיישום הטכני המפורט שמניע את פתרון ניתוחי הקמעונאות שלנו.

## 📚 משאבים נוספים

### תיעוד MCP
- [MCP Specification](https://modelcontextprotocol.io/docs/) - תיעוד פרוטוקול רשמי  
- [MCP for Beginners](https://aka.ms/mcp-for-beginners) - מדריך למידה מקיף על MCP  
- [FastMCP Documentation](https://github.com/modelcontextprotocol/python-sdk) - תיעוד SDK של Python  

### שילוב מסדי נתונים
- [PostgreSQL Documentation](https://www.postgresql.org/docs/) - מדריך PostgreSQL מלא  
- [pgvector Guide](https://github.com/pgvector/pgvector) - תיעוד הרחבת וקטורים  
- [Row Level Security](https://www.postgresql.org/docs/current/ddl-rowsecurity.html) - מדריך RLS של PostgreSQL  

### שירותי Azure
- [Azure OpenAI Documentation](https://docs.microsoft.com/azure/cognitive-services/openai/) - אינטגרציה עם שירותי AI  
- [Azure Database for PostgreSQL](https://docs.microsoft.com/azure/postgresql/) - שירות מסד נתונים מנוהל  
- [Azure Container Apps](https://docs.microsoft.com/azure/container-apps/) - קונטיינרים ללא שרת  

---

**הצהרה**: זהו תרגיל למידה המשתמש בנתוני קמעונאות בדיוניים. תמיד עקבו אחר מדיניות הארגון שלכם בנוגע לניהול נתונים ואבטחה בעת יישום פתרונות דומים בסביבות ייצור.

---

**כתב ויתור**:  
מסמך זה תורגם באמצעות שירות תרגום מבוסס AI [Co-op Translator](https://github.com/Azure/co-op-translator). למרות שאנו שואפים לדיוק, יש לקחת בחשבון שתרגומים אוטומטיים עשויים להכיל שגיאות או אי דיוקים. המסמך המקורי בשפתו המקורית צריך להיחשב כמקור הסמכותי. עבור מידע קריטי, מומלץ להשתמש בתרגום מקצועי על ידי אדם. איננו נושאים באחריות לאי הבנות או לפרשנויות שגויות הנובעות משימוש בתרגום זה.